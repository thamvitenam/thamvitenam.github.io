{"version":3,"file":"js/823.dab56435.js","mappings":"6QACEA,EAAAA,EAAAA,IAEYC,EAAA,CAFDC,MAAM,eAAgBC,SAAQC,EAAAC,YAAaC,SAAA,GAAS,iBAAa,mBAAiB,EAAQC,SAAU,K,mBAC7F,IAAsB,gBAAtCC,EAAAA,EAAAA,IAAgGC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAAjEC,EAAAC,QAARC,K,WAAvBb,EAAAA,EAAAA,IAAgGc,EAAA,CAAxDC,IAAKF,EAAKG,GAAKA,GAAE,SAAaH,EAAKG,I,sFAU7E,GACEC,KAAM,OACNC,WAAY,CAAC,EACbC,IAAAA,GACE,MAAO,CACLP,OAAQ,GACRQ,QAAS,GACTC,QAAS,EACTC,SAAU,EAEd,EACAC,MAAO,CAAC,EACRC,SAAU,CAAC,EACXC,QAAS,KACJC,EAAAA,EAAAA,IAAW,CACZC,cAAe,yBAEjBtB,WAAAA,CAAYuB,GACVC,KAAKT,QAAQU,SAAQjB,IACnBA,EAAKkB,OAAO,IAEVH,GAAUC,KAAKT,QAAQY,OAAS,IAClCH,KAAKR,QAAUQ,KAAKR,QAAU,EAC9BQ,KAAKI,WAAU,GAEnB,EACA,eAAMA,CAAUC,GACVA,GACFL,KAAKF,eAAc,GAErB,IACE,IAAI,KAACQ,EAAI,KAAEC,SAAcC,EAAAA,GAAc,CACrChB,QAASQ,KAAKR,QACdC,SAAUO,KAAKP,WAEL,KAARc,GAAeD,EAAKH,SACtBH,KAAKjB,OAASiB,KAAKjB,OAAO0B,OAAOH,GACjCA,EAAKL,SAAQjB,IACXgB,KAAKU,WAAW1B,EAAK,IAG3B,CAAE,MAAO2B,GAET,CAAE,QACAX,KAAKF,eAAc,EACrB,CACF,EACAY,UAAAA,CAAW1B,GACT4B,YAAW,KACTC,SAASC,eAAe,SAAW9B,EAAKG,IAAI4B,UAAa,uBAAsB/B,EAAKG,gCACpFyB,YAAW,KACTZ,KAAKT,QAAQyB,MAAKC,EAAAA,EAAAA,GAAQJ,SAASC,eAAe,YAAc9B,EAAKG,IAAK,CACxE+B,UAAU,EACVC,OAAO,EACPC,OAAO,EACPC,OAAQ,OACRC,OAAQtC,EAAKuC,WACbC,QAAS,CACP,CACEC,IAAKzC,EAAK0C,MACVC,KAAM,4BAGT,WACH,IAAG,GACF,EAAE,GACJ,EACL,GAEFC,OAAAA,GACE5B,KAAKI,WAAU,EACjB,EACAyB,aAAAA,GACM7B,KAAKT,QAAQY,QACfH,KAAKT,QAAQU,SAAQjB,IACnBA,EAAK8C,SAAS,GAGpB,G,QCnFJ,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://new-web/./src/views/look/index.vue","webpack://new-web/./src/views/look/index.vue?1665"],"sourcesContent":["<template>\r\n  <van-swipe class=\"video-swiper\" @change=\"videoChange\" vertical lazy-render :show-indicators=\"false\" :duration=\"300\">\r\n    <van-swipe-item v-for=\"item in videos\" :key=\"item.id\" :id=\"'swipe-' + item.id\"></van-swipe-item>\r\n  </van-swipe>\r\n</template>\r\n\r\n<script>\r\n  import * as api from '@/api'\r\n  import {mapActions} from 'vuex';\r\n  import 'video.js/dist/video-js.css';\r\n  import VideoJs from 'video.js';\r\n  // import {uniqueId} from 'lodash'\r\n  export default {\r\n    name: \"Look\",\r\n    components: {},\r\n    data() {\r\n      return {\r\n        videos: [],\r\n        players: [],\r\n        pageNum: 1,\r\n        pageSize: 6\r\n      }\r\n    },\r\n    watch: {},\r\n    computed: {},\r\n    methods: {\r\n      ...mapActions({\r\n        toggleLoading: 'common/toggleLoading',\r\n      }),\r\n      videoChange(curIdx) {\r\n        this.players.forEach(item => {\r\n          item.pause()\r\n        })\r\n        if (curIdx == this.players.length - 3) {\r\n          this.pageNum = this.pageNum + 1;\r\n          this.getVideos(false);\r\n        }\r\n      },\r\n      async getVideos(loading) {\r\n        if (loading) {\r\n          this.toggleLoading(true)\r\n        }\r\n        try {\r\n          let {rows, code} = await api.getVideos({\r\n            pageNum: this.pageNum,\r\n            pageSize: this.pageSize,\r\n          })\r\n          if (code == 200 && rows.length) {\r\n            this.videos = this.videos.concat(rows);\r\n            rows.forEach(item => {\r\n              this.initPlayer(item)\r\n            })\r\n          }\r\n        } catch (e) {\r\n\r\n        } finally {\r\n          this.toggleLoading(false)\r\n        }\r\n      },\r\n      initPlayer(item) {\r\n        setTimeout(() => {\r\n          document.getElementById('swipe-' + item.id).innerHTML = `<video id=\"video-js-${item.id}\" class=\"video-js\"></video>`\r\n          setTimeout(() => {\r\n            this.players.push(VideoJs(document.getElementById('video-js-' + item.id), {\r\n              controls: true,\r\n              muted: true,\r\n              fluid: true,\r\n              reload: \"auto\",\r\n              poster: item.videoCover,\r\n              sources: [\r\n                {\r\n                  src: item.video,\r\n                  type: 'application/x-mpegURL',\r\n                },\r\n              ],\r\n            }, function onPlayerReady() {\r\n            }))\r\n          }, 0)\r\n        }, 0)\r\n      },\r\n    },\r\n    mounted() {\r\n      this.getVideos(true);\r\n    },\r\n    beforeUnmount() {\r\n      if (this.players.length) {\r\n        this.players.forEach(item => {\r\n          item.dispose()\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n  .video-swiper{\r\n    height: calc(100vh - 58px);\r\n  }\r\n  :deep(.van-swipe-item) {\r\n    .video-js{\r\n      width: 100%!important;\r\n      height: 100%!important;\r\n      background: none;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=6c140fef&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=6c140fef&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6c140fef\"]])\n\nexport default __exports__"],"names":["_createBlock","_component_van_swipe","class","onChange","$options","videoChange","vertical","duration","_createElementBlock","_Fragment","_renderList","$data","videos","item","_component_van_swipe_item","key","id","name","components","data","players","pageNum","pageSize","watch","computed","methods","mapActions","toggleLoading","curIdx","this","forEach","pause","length","getVideos","loading","rows","code","api","concat","initPlayer","e","setTimeout","document","getElementById","innerHTML","push","VideoJs","controls","muted","fluid","reload","poster","videoCover","sources","src","video","type","mounted","beforeUnmount","dispose","__exports__","render"],"sourceRoot":""}